<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ExamDAO">
	<!-- 190703 재홍 CRUD 쿼리 입력 -->
	<!-- 시험 등록 -->
	<!-- 2019.07.09 성재민 -->
	<!-- #{disclosureStatus} #{setExamStatus} 추가 -->
	<insert id="insertExam" parameterType="ExamVO">
		INSERT INTO EXAM (	
							EXAM_ID
						,	EXAM_START_TIME
						,	EXAM_END_TIME
						,	QUESTION_QUANTITY
						,	ESTIMATE_ID
						,	NUMBER_OF_TIMES
						,	PASSING_SCORE
						,	POSSIBLE_APPLICANTS
						,	EXAM_NAME
						,	EXAM_STATUS
						,	DISCLOSURE_STATUS
						,	SET_EXAM_STATUS
					)
		VALUES ( 
					#{examId}
				,	#{examStartTime}
				,	#{examEndTime}
				,	#{questionQuantity}
				,	#{estimateId}
				,	#{numberOfTimes}
				,	#{passingScore}
				,	#{possibleApplicants}
				,	#{examName}
				,	#{examStatus} 
				,	#{disclosureStatus} 
				,	#{setExamStatus} 
			)
	</insert>
	
	<!-- 2019.07.09 성재민 -->
	<!-- 업데이트 추가 -->
	<update id="updateExam" parameterType="ExamVO">
		UPDATE EXAM
		<set>	
			EXAM_START_TIME   		= #{examStartTime}
			, EXAM_END_TIME			= #{examEndTime}
			, QUESTION_QUANTITY 	= #{questionQuantity}
			, ESTIMATE_ID  			= #{estimateId}
			, NUMBER_OF_TIMES 		= #{numberOfTimes}
			, PASSING_SCORE 		= #{passingScore}
			, POSSIBLE_APPLICANTS 	= #{possibleApplicants}
			, EXAM_NAME 			= #{examName}
			, EXAM_STATUS 			= #{examStatus}
			, DISCLOSURE_STATUS 	= #{disclosureStatus}
			, SET_EXAM_STATUS 		= #{setExamStatus}
		</set>
		<where>
			EXAM_ID = #{examId}
		</where>
	</update>
	
	<!-- 2019.07.09 성재민 -->
	<!-- 삭제 추가 -->
	<delete id="deleteExam" parameterType="ExamVO">
		DELETE FROM EXAM
		<where>
			EXAM_ID = #{examId}
		</where>
	</delete>
	
	<!-- 2019.07.09 성재민 -->
	<!-- select 추가 -->
	<select id="getExam" resultType="ExamVO">
	SELECT B.* FROM( SELECT A.*, ROWNUM RN FROM (
		SELECT 
				EXAM_ID
			,	EXAM_START_TIME
			,	EXAM_END_TIME
			,	QUESTION_QUANTITY
			,	ESTIMATE_ID
			,	NUMBER_OF_TIMES
			,	PASSING_SCORE
			,	POSSIBLE_APPLICANTS
			,	EXAM_NAME
			,	EXAM_STATUS
			,	DISCLOSURE_STATUS
			,	SET_EXAM_STATUS
			,	EXAM_DESCRIPTION_SIMPLE
			,	EXAM_DESCRIPTION_DETAIL
		FROM EXAM
		<where>
			EXAM_ID = #{examId}
		</where>
		ORDER BY EXAM_ID
	) A ) B
	<where>
			RN BETWEEN #{start} AND #{end}
	</where>
		
	</select>
	
	<select id="getExamList" resultType="ExamVO">
		SELECT 
				EXAM_ID
			,	EXAM_START_TIME
			,	EXAM_END_TIME
			,	QUESTION_QUANTITY
			,	ESTIMATE_ID
			,	NUMBER_OF_TIMES
			,	PASSING_SCORE
			,	POSSIBLE_APPLICANTS
			,	EXAM_NAME
			,	EXAM_STATUS
			,	DISCLOSURE_STATUS
			,	SET_EXAM_STATUS
		FROM EXAM
	</select>
	<select id="getExamCount" resultType="int">
		SELECT COUNT(*)
		FROM EXAM
	</select>
</mapper>